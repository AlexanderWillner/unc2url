#!/usr/bin/env pwsh
###############################################################################
# Helper script to open SMB URLs on Windows
# Author: Alexander Willner
###############################################################################


# setup #######################################################################
$url = $args[0]
$script = $MyInvocation.MyCommand.Name
###############################################################################


# check input #################################################################
if (-not ($url -like 'smb://*')) {
    write-error "Usage: $script <smb://...>"
    exit 1
}
###############################################################################


# translate ###################################################################
$url = [System.Net.WebUtility]::UrlDecode($url)
$url = $url -replace 'smb://','\\'
$url = $url -replace '/','\'
###############################################################################


# open URL ####################################################################
write-Output "Opening '$url'..."
Start-Process -Path "$url"
###############################################################################
